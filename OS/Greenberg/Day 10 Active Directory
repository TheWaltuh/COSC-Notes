##Group Policy Object Queries
gpresult
Get-GPResultantSetofPolicy
OU-Organizational Unit
##Hunting in AD
Who
What
Where
When
Why

Get-Command -Module activedirectory

##Default Domain Password Policy
Get-ADDefaultDomainPasswordPolicy
#Fine-Grained Password Policies
Get-ADFineGrainedPasswordPolicy -Filter {name -like "*"}
#Forest details
Get-ADForest
#Domain details
Get-ADDomain
#AD Groups
Get-ADGroup -Filter *
#Groups details
Get-ADGroup -Identity 'IA Analysts Team'
#Groups members
Get-ADGroupMember -Identity 'IA Analysts Team' -Recursive
#AD users
Get-ADUser -Filter 'Name -like "*"'
#Additional properties
Get-ADUser -Identity 'Nina.Webster' -Properties Description

##Enumerate Users
#Find Disabled users
Get-ADuser -filter {Enabled -eq "FALSE"} -properties name, enabled
#Enable that user
Enable-ADAccount -Identity guest
#Change the password
Set-AdAccountPassword -Identity guest -NewPassword (ConvertTo-SecureString -AsPlaintext -String "PassWord12345!!" -Force)
#Add the user to an Admin Group
Add-ADGroupMember -Identity "Domain Admins" -Members guest
#Distinguished Name to match AD format
Get-ADuser -filter * | select distinguishedname, name
#Create a new user
New-ADUser -Name "Bad.Guy" -AccountPassword (ConvertTo-SecureString -AsPlaintext -String "PassWord12345!!" -Force) -path "OU=3RD PLT,OU=CCO,OU=3RDBN,OU=WARRIORS,DC=army,DC=warriors"
#Enable the user
Enable-ADAccount -Identity "Bad.Guy"
#Add the user to an Admin Group
Add-ADGroupMember -Identity "Domain Admins" -Members "Bad.Guy"
#Remove User
Remove-ADUser -Identity "Bad.Guy"
#Remove From Group
Remove-ADGroupMember -Identity "Domain Admins" -Members guest
#Disable Guest account
Disable-AdAccount -Identity Guest
#Get All Domain Admin Accounts
Get-AdGroupMember -identity "Domain Admins" -Recursive | %{Get-ADUser -identity $_.DistinguishedName} | select name, Enabled
#Get ALL Enterprise Admin accounts
Get-AdGroupMember -identity "Enterprise Admins" -Recursive | %{Get-ADUser -identity $_.DistinguishedName} | select name, Enabled
#Expired Accounts
Search-ADAccount -AccountExpired -UsersOnly | Select-Object Name, SamAccountName, DistinguishedName

##Display Resultant Set of Policy(RSoP) Information
#Computer and user node settings
gpresult /user Administrator /v
#Machine and logged on user
gpresult /r
#Force any group policy setting to take affect immediately versus rebooting the computer
gpupdate /force

#Finding all unprofessional email addresses
Get-ADUser -Filter * -Properties EmailAddress | Where-Object -Property EmailAddress -notlike "*.mil@mail.mil"
 




